# EMIPredict AI — Credit Risk & EMI Eligibility Prediction

This project builds an end-to-end **loan EMI eligibility prediction system** capable of:
1. **Classifying** whether an applicant is *Eligible*, *High_Risk*, or *Not_Eligible*
2. **Predicting** the **maximum safe EMI amount** the user can sustain

The pipeline includes **data preprocessing, feature engineering, ML modeling, MLflow experiment tracking, and a Streamlit app** for real-time prediction deployment.

---

## 1. Problem Statement

Financial institutions face high **credit default** risks when EMI obligations exceed applicant affordability.  
This project estimates **loan repayment capability** using behavioral, income, expense, credit profile, and liquidity indicators.

---

## 2. Dataset Description

Source: `emi_prediction_dataset.csv` (private structured dataset)

| Column Group | Examples |
|-------------|----------|
| Demographics | age, gender, marital_status, family_size |
| Financial Profile | monthly_salary, emergency_fund, bank_balance |
| Credit Behavior | credit_score, existing_loans, current_emi_amount |
| Expense Structure | rent, school_fees, groceries_utilities, other_expenses |
| Loan Request | requested_amount, requested_tenure, emi_scenario |
| Targets | `emi_eligibility` *(classification)*, `max_monthly_emi` *(regression)* |

Final cleaned dataset stored at:

/data/processed/emi_clean.parquet
/data/processed/emi_features.parquet


---

## 3. Data Preprocessing (`data_loader.py`)

Key cleaning steps:
- Robust numeric parsing (`pd.to_numeric(errors='coerce')`)
- Imputation:
  - Numeric → Median
  - Categorical → Mode / `Unknown`
- Standardization of categorical values (ex: gender normalization)
- Duplicate removal & dtype optimization
- Stratified Train / Validation / Test splitting

---

## 4. Feature Engineering (`feature_engineering.py`)

Feature engineering focuses on **Affordability, Liquidity, Stability**, and **Risk**:

| Feature | Meaning |
|--------|---------|
| `dti_ratio` | Total Expenses / Income |
| `emi_to_income` | Current EMI Load %
| `affordability_gap` | max_monthly_emi − requested_emi |
| `stability_score` | Employment + Credit stability score |
| `existing_loan_flag`, `has_dependents` | Risk pressure indicators |
| `dti_bucket`, `credit_bucket` | Binned creditworthiness levels |

All infinite / invalid calculations are safely clipped & imputed.

---

## 5. Modeling

### **Classification** (Eligibility Prediction)
Model: **XGBoost Classifier**

| Metric | Score |
|--------|------|
| Accuracy | **99.78%** |
| F1 Score (macro) | **0.9986** |
| ROC-AUC (OVR) | **0.9998** |

**Confusion Summary:** only **22 misclassifications** across 10,000 evaluations.

---

### **Regression** (Max EMI Prediction)
Model: **XGBoost Regressor**

| Metric | Value | Interpretation |
|--------|-------|----------------|
| RMSE | **₹313** | Avg error of ±₹313 from true EMI |
| MAE | **₹199** | Highly precise prediction |
| R² | **0.997** | Explains 99.7% variance |

---

## 6. Model Tracking (`mlflow_config.py`)
All model runs are logged using **MLflow** with:
- Metrics (AUC, F1, RMSE, MAE, R²)
- Artifacts (model.pkl, conda.yaml)
- Signatures & Input Examples for deployment safety

Tracking URI:
mlruns/


---

## 7. Streamlit App (`app/Home.py`)

Launch UI:
```bash
streamlit run app/Home.py

Features:

Real-time EMI approval classification

Maximum safe EMI calculation

Confidence scoring & risk color coding

Financial advisories for borderline cases
--- 

8. Project Structure

EMIpredict/
│ train_reg.py
│ requirements.txt
│ app/Home.py
│
├── data/
│   └── processed/
│       ├── emi_clean.parquet
│       └── emi_features.parquet
│
├── src/
│   ├── diagnose_dataset.py
│   ├── data_loader.py
│   ├── feature_engineering.py
│   ├── mlflow_config.py
│   └── models/
│       ├── baseline.py
│       ├── classification.py
│       └── regression.py
│
└── mlruns/ (auto-generated by MLflow)


9. To Train Models Manually

python src/models/classification.py
python src/models/regression.py


10. Future Enhancements

Add SHAP explainability dashboard

Deploy API endpoint with FastAPI

Add database backend for customer session logging

Deploy Streamlit UI to Streamlit Cloud / AWS / Render

11. Author

Faizan Rasool
Machine Learning Engineer
GitHub: https://github.com/faizan1343

